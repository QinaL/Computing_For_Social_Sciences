

```{r}
library(httr)
library(jsonlite)
library(rvest)
library(XML)
library(xml2)
library(tidyverse)
```

```{r}
ex <- GET(url = "https://www.ncbi.nlm.nih.gov/pmc/utils/oa/oa.fcgi?", 
          query = list(
            from = "2023-07-01"
          )) 


ex1 <- read_xml(ex)
nodes <- xml_find_all(ex1, "/OA//records//record")
xmlToDataFrame(nodes)

h <- bind_rows(lapply(xml_attrs(nodes), function(x) data.frame(as.list(x))))
#https://stackoverflow.com/questions/34511885/convert-xml-nodeset-to-data-frame

h2 <- nodes %>%
  map(xml_attrs) %>% 
  map_df(~as.list(.))

h2 %>%
  group_by(license) %>%
  count()

list1 <- as_list(ex1)

is_empty(xml_attr(xml_find_all(ex1, "/OA//records//resumption//link"), "token"))

ex
parsed <- xmlParse(ex) 


parsed
xmlToDataFrame(ex1, nodes = "/OA//records")
```

37422108


6:00 - 6:38 PM


